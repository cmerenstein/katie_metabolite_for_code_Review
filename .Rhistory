data <- read_xlsx(path = path, col_names = TRUE)
fix_data <- data %>%
mutate_at(vars("HDC", "Int", "LDC"), as.numeric)
return(fix_data)
}
#retrieve data from individual metabolomics studies
McMillan <- retrieve_FUN("McMillan")
Yeoman <- retrieve_FUN("Yeoman")
Srinivasan <- retrieve_FUN("Srinivasan")
Vitali <- retrieve_FUN("Vitali")
#merge dataframes
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6])
#, Srinivasan[,"Study":"LDC"], Vitali[,"Study":"LDC"])
#extract all metabolite names from literature studies
#lit_metabolites <- merge_FUN
View(lit_master)
#extract metabolite names from literature
lit_master %>%
select(Metabolite)
rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown'))
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., Metabolite, tolower)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower)
lit_master$Metabolite
#merge dataframes and remove metabolites with unknown names
rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(Metabolite = gsub(pattern = " \\(*\\)", "", Metabolite))
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(Metabolite = gsub(pattern = " \\(*\\)", "", Metabolite))
lit_master$Metabolite
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(Metabolite = gsub(pattern = " \\(^*\\)", "", Metabolite))
lit_master$Metabolite
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(Metabolite = gsub(pattern = " \\(.*\\)", "", Metabolite))
lit_master$Metabolite
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(Metabolite = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(Metabolite = gsub(pattern = "\\*", "", Metabolite))
head(lit_master)
lit_master$Metabolite
library(stringr)
mutate(name_search = str_split_n(name_search, pattern = 'isobar:', 2)
mutate(name_search = str_split_n(name_search, pattern = 'isobar:', 2)
filter(!str_detect(Metabolite, 'unknown')) %>%
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split_n(name_search, pattern = 'isobar:', 2))
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search))
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(str_split_n(name_search, pattern = 'isobar:', 2))
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split_fixed(name_search, pattern = 'isobar:', 3))
lit_master$name_search
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split_fixed(name_search, pattern = '$isobar: ^;', 3))
lit_master$name_search
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split_fixed(name_search, pattern = '$isobar: ^,', 3))
lit_master$name_search
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split_fixed(name_search, pattern = 'isobar: '))
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split(name_search, pattern = 'isobar: '))
lit_master$name_search
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = str_split(name_search, pattern = 'isobar: ')[2])
lit_master$name_search
rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = "\\s\\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search))
rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search))
lit_master$name_search
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) #%>%
lit_master$name_search
mutate(name_search = gsub(pattern = ", .*$" , "", name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*: ", "", name_search)) %>%
mutate(name_search = gsub(pattern = ", .*$" , "", name_search))
lit_master$name_search
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*: ", "", name_search)) %>%
mutate(name_search = gsub(pattern = ", .*$" , "", name_search)) %>%
mutate(name_search = gsub(pattern = "; .*$" , "", name_search))
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*: ", "", name_search)) %>%
mutate(name_search = gsub(pattern = ", .*$" , "", name_search)) %>%
mutate(name_search = gsub(pattern = "; .*$" , "", name_search))
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\1", name_search)) #%>%
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) #%>%
lit_master %>%
select(Metabolite, name_search)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) #%>%
lit_master %>%
select(Metabolite, name_search)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*),.*", "\\1", name_search))
lit_master %>%
select(Metabolite, name_search)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search))
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gusb(pattern = "^a_.*", 'alpha-', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search))
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_.*", 'alpha-', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search))
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search))
lit_master %>%
select(Metabolite, name_search)
#merge dataframes and remove metabolites with unknown names
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search))
lit_master %>%
select(Metabolite, name_search)
View(lit_master)
#write master dataframe to file for HMDB metabolite name correction
write_xlsx(lit_master, 'literature_metabolites.xlsx')
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search))
lit_master %>%
select(Metabolite, name_search)
lit_master$name_search
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^a-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search))
lit_master %>%
select(Metabolite, name_search)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^a-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search)) %>%
mutate(name)search = gsub(pattern = "inositol, (.*))", "\\1-inositol", name_search))
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^a-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search)) %>%
mutate(name_search = gsub(pattern = "inositol, (.*))", "\\1-inositol", name_search))
lit_master %>%
select(Metabolite, name_search)
lit_master %>%
select(Metabolite, name_search)
View(lit_master)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^a-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search)) %>%
mutate(name_search = gsub(pattern = "inositol, (.*)", "\\1-inositol", name_search))
lit_master %>%
select(Metabolite, name_search)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^a-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search)) %>%
mutate(name_search = gsub(pattern = "inositol, (.*)", "\\1inositol", name_search))
lit_master %>%
select(Metabolite, name_search)
lit_master <- rbind.data.frame(McMillan[,1:6], Yeoman[,1:6], Srinivasan[,1:6], Vitali[,1:6]) %>%
filter(!str_detect(Metabolite, 'unknown')) %>%
mutate_at(., "Metabolite", tolower) %>%
mutate(name_search = gsub(pattern = " \\(.*\\)", "", Metabolite)) %>%
mutate(name_search = gsub(pattern = "\\*", "", name_search)) %>%
mutate(name_search = gsub(pattern = "^a_(.*)", 'alpha-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^alpha-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "^a-(.*)", '2-\\1', name_search)) %>%
mutate(name_search = gsub(pattern = "_", " ", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*);.*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = "^.*:(.*), .*", "\\1", name_search)) %>%
mutate(name_search = gsub(pattern = " \\[.*\\]", "", name_search)) %>%
mutate(name_search = gsub(pattern = "inositol, (.*)", "\\1inositol", name_search)) %>%
mutate(name_search= gsub(pattern = "(.*)-p$", "\\1-phosphate", name_search))
lit_master %>%
select(Metabolite, name_search)
#write master dataframe to file for HMDB metabolite name correction
write_xlsx(lit_master, 'literature_metabolites.xlsx')
knitr::opts_chunk$set(echo = TRUE)
#load required packages
library(readxl)
#library(Hmisc)
library(dplyr)
library(stringr)
library(ggplot2)
#library(ggpubr)
#library(scales)
library(reshape2)
library(data.table)
library(writexl)
#run HMDB_interface_script.py in python2 to perform metabolite name correction
read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F)
#run HMDB_interface_script.py in python2 to perform metabolite name correction
read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F, sep = ",")
test <- read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F, sep = ",")
#load metabolite database
metabolite_DB <- read.csv2(file = 'hmdb_metabolites.csv', header = TRUE, stringsAsFactors = F, sep = ",")
test <- read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F, sep = ",") %>% rename('traditional_iupac' == HMDB_corrected_name)
test <- read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F, sep = ",") %>% rename(traditional_iupac == 'HMDB_corrected_name')
test <- read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F, sep = ",") %>% rename('traditional_iupac' == 'HMDB_corrected_name')
test <- read.csv2(file = 'literature_metabolites_name_correction.csv', header = TRUE, stringsAsFactors = F, sep = ",") %>% rename(traditional_iupac = 'HMDB_corrected_name')
left_join(test, metabolite_DB, by = 'traditional_iupac') %>% select(Study_Metabolite, traditional_iupac, smiles)
process_corrected_names <- function (infile) {
#load data
data <- read.csv2(file = infile, header = TRUE, stringsAsFactors = F, sep = ",") %>%
rename('traditional_iupac' == HMDB_corrected_name)
#match names to HMDB database to retrieve SMILES
match <- left_join(data, metabolite_DB, by = 'traditional_iupac') %>%
select(Study_Metabolite, traditional_iupac, smiles)
#return values
return(match)
}
process_corrected_names(infile = 'literature_metabolites_name_correction.csv')
#run HMDB_interface_script.py in python2 to perform metabolite name correction
process_corrected_names <- function (infile) {
#load data
data <- read.csv2(file = infile, header = TRUE, stringsAsFactors = F, sep = ",") %>%
rename('traditional_iupac' = HMDB_corrected_name)
#match names to HMDB database to retrieve SMILES
match <- left_join(data, metabolite_DB, by = 'traditional_iupac') %>%
select(Study_Metabolite, traditional_iupac, smiles)
#return values
return(match)
}
process_corrected_names(infile = 'literature_metabolites_name_correction.csv')
lit_metabolites <- process_corrected_names(infile = 'literature_metabolites_name_correction.csv')
lit_metabolites
#manually review unmatched metabolites
unmatched_lit <- lit_metabolites %>%
filter(traditional_iupac == 'No_match_found')
table(unmatched_lit)
dim(unmatched_lit)
umatched_lit
unmatched_lit
#manually review unmatched metabolites
unmatched_lit <- lit_metabolites %>%
filter(traditional_iupac == 'No_match_found')
write_xlsx(unmatched_lit, 'unmatched_literature_metabolites.xlsx')
View(lit_metabolites)
View(McMillan)
View(Yeoman)
knitr::opts_chunk$set(echo = TRUE)
#load required packages
library(readxl)
#library(Hmisc)
library(dplyr)
library(stringr)
library(ggplot2)
#library(ggpubr)
#library(scales)
library(reshape2)
library(data.table)
library(writexl)
#re-upload unmatched literature metabolites
complete_unmatched_lit <- read_xlsx(path = 'unmatched_literature_metabolites.xlsx', header = TRUE, stringsAsFactors = F)
#re-upload unmatched literature metabolites
complete_unmatched_lit <- read_xlsx(path = 'unmatched_literature_metabolites.xlsx', header = TRUE
#re-upload unmatched literature metabolites
complete_unmatched_lit <- read_xlsx(path = 'unmatched_literature_metabolites.xlsx', header = TRUE)
#re-upload unmatched literature metabolites
complete_unmatched_lit <- read_xlsx(path = 'unmatched_literature_metabolites.xlsx', header = TRUE)
#re-upload unmatched literature metabolites
complete_unmatched_lit <- read_xlsx(path = 'unmatched_literature_metabolites.xlsx')
#merge files
lit_metabolites <- rbind.data.frame(lit_metabolites, complete_unmatched_lit) %>% filter(traditional_iupac == 'No_match_found')
lit_metabolites <- process_corrected_names(infile = 'literature_metabolites_name_correction.csv')
View(complete_unmatched_lit)
#merge files
lit_metabolites <- rbind.data.frame(lit_metabolites %>% filter(traditional_iupac != 'No_match_found'),
complete_unmatched_lit %>% filter(traditional_iupac != 'No_match_found'))
#combine lit metabolite data with smiles
lit_data <- left_join(lit_master %>% rename('Study_Metabolite' = name_search), lit_metabolites)
View(lit_data)
#combine lit metabolite data with smiles
lit_data <- left_join(lit_master %>% rename('Study_Metabolite' = name_search), lit_metabolites) %>%
filter(traditional_iupac != 'No_match_found') %>%
select(Study, traditional_iupac, smiles, HDC, Int, LDC)
#combine lit metabolite data with smiles
lit_data <- left_join(lit_master %>% rename('Study_Metabolite' = name_search), lit_metabolites) %>%
filter(traditional_iupac != 'No_match_found')# %>%
#combine lit metabolite data with smiles
lit_data <- left_join(lit_master %>% rename('Study_Metabolite' = name_search), lit_metabolites) %>%
filter(traditional_iupac != 'No_match_found') %>%
distinct(.) %>%
select(Study, traditional_iupac, smiles, HDC, Int, LDC)
